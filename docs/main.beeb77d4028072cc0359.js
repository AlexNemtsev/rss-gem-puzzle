(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var o=e.g.document;if(!t&&o&&(o.currentScript&&(t=o.currentScript.src),!t)){var r=o.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=document.createElement("h2"),o=document.createElement("ol");let r;o.className="top-10-list";const n=()=>r=JSON.parse(localStorage.getItem("top"))??{3:[],4:[],5:[],6:[],7:[],8:[]},a=e=>{t.textContent=`Top ${e}x${e}`;const n=o.children;for(;0!==n.length;)n[0].remove();for(let t=0;t<10;t++){const n=document.createElement("li");n.textContent=r[e][t]?`${r[e][t]} moves`:"",o.append(n)}};let l=localStorage.getItem("sound")??"";const c=document.createElement("label"),s=document.createElement("input");s.checked=l,s.type="checkbox",c.textContent="Sound",c.append(s),s.addEventListener("change",(e=>{const t=e.target;l=t.checked?1:"",localStorage.setItem("sound",l)}));const m=document.createElement("p"),d=()=>m.textContent=`Moves: ${i}`;let i=localStorage.getItem("moves")??0;const u=e.p+"cc557028216a0bac23c4.wav",p=e=>{const t=e.currentTarget;if(T(t)){const o=e.pageX,r=e.pageY,n=e=>{const t=e.currentTarget,a=e=>{const t=e.currentTarget;t.style.transform="translate(0, 0)",t.removeEventListener("mousemove",n),t.removeEventListener("mouseout",a)},l=(e,o)=>{const r=Math.abs(e);return t.addEventListener("mouseup",(e=>{e.currentTarget.removeEventListener("mouseout",a)})),r>=300/f()?(t.addEventListener("mouseout",a),300/f()*o):e/r!==o?(t.addEventListener("mouseout",a),0):r*o},c=l(e.pageX-o,w.column-t.style.gridColumnStart),s=l(e.pageY-r,w.row-t.style.gridRowStart);t.style.transform=`translate(${c}px, ${s}px)`};t.addEventListener("mousemove",n),t.addEventListener("mouseup",(e=>{e.currentTarget.removeEventListener("mousemove",n)}))}},g=document.createElement("form"),v=document.createElement("button"),S=document.createElement("select");S.append(...(()=>{const e=[];for(let t=3;t<=8;t++){const o=document.createElement("option");o.setAttribute("value",t),4===t&&o.setAttribute("selected",!0),o.innerHTML=`${t}x${t}`,e.push(o)}return e})()),g.className="form",v.type="submit",v.innerHTML='<div class="rect">New game</div>',g.append(v),g.append(S);const f=()=>Number(localStorage.getItem("fieldSize")??S.value),h=()=>`repeat(${f()}, 1fr) / repeat(${f()}, 1fr)`,y=document.createElement("div");y.className="grid",y.style.gridTemplate=h();const E=()=>localStorage.setItem("empty",JSON.stringify(w));let w=JSON.parse(localStorage.getItem("empty"))??{row:f(),column:f()};const b=e=>w=e,I=e=>{const t=y.children,o={};for(let e of t)o[e.textContent]={row:e.style.gridRowStart,column:e.style.gridColumnStart};localStorage.setItem("field",JSON.stringify(o)),localStorage.setItem("fieldSize",e)},$=(e,t,o)=>{const r=document.createElement("div"),n=document.createElement("div");r.append(n),n.append(o),r.className="grid__elem",n.className="circle",r.style.gridArea=`${e}/${t}/span 1/span 1`,r.addEventListener("click",M),r.addEventListener("mousedown",p),y.append(r)},N=e=>{const t=(()=>{const e=[];for(let t=1;t<f()*f();t++)e.push(t);if(e.sort((()=>Math.random()-.5)),e.reduce(((e,t,o,r)=>e+r.slice(o+1).reduce(((e,o)=>e+(o<t?1:0)),0)),0)%2==1){const t=e[e.length-1];e[e.length-1]=e[e.length-2],e[e.length-2]=t}return e})();for(let o=0;o<e*e-1;o++){const r=Math.floor(o/e)+1;$(r,o%e+1,t[o])}I(e),E()},L=()=>{for(;0!==y.children.length;)y.children[0].remove()},T=e=>{const t=e.style.gridColumnStart,o=e.style.gridRowStart-w.row,r=t-w.column;return 1===Math.abs(r)&&0===Math.abs(o)||0===Math.abs(r)&&1===Math.abs(o)},x=new Audio(u),C=()=>{const e=y.children;return Object.keys(e).every((t=>{const o=Number(e[t].style.gridColumnStart),r=Number(e[t].style.gridRowStart),n=Number(e[t].textContent);return(r-1)*f()+o===n}))},M=e=>{const t=e.currentTarget;if(T(t)){const e=(e=>{const t=e.cloneNode(!0);return t.style.gridColumnStart=`${w.column}`,t.style.gridRowStart=`${w.row}`,t.style.transform="translate(0, 0)",t.addEventListener("click",M),t.addEventListener("mousedown",p),t})(t);(e=>{const t={row:Number(e.style.gridRowStart),column:Number(e.style.gridColumnStart)};e.style.transform=`translate(${100*(w.column-t.column)}%, ${100*(w.row-t.row)}%)`,e.style.transition="250ms",b(t)})(t),i++,localStorage.setItem("moves",i),J(),d(),l&&(x.currentTime=0,x.play()),setTimeout((()=>{t.remove(),y.append(e),I(f()),E(),C()&&(alert(`Hooray! You solved the puzzle in ${O.textContent} and ${i} moves!`),((e,t)=>{const o=(e,t)=>{r[t].push(e),r[t].sort(((e,t)=>e-t)),localStorage.setItem("top",JSON.stringify(r))};r[t].length<10?o(e,t):e<Math.max(...r[t])&&(r[t].pop(),o(e,t))})(i,f()),a(f()),L(),localStorage.removeItem("field"),localStorage.removeItem("fieldSize"),localStorage.removeItem("empty"),localStorage.removeItem("moves"),localStorage.removeItem("time"))}),250)}},O=document.createElement("p");let k=localStorage.getItem("time")??0;const z=()=>{C()||k++;const e=`${Math.floor(k/60)}`.padStart(2,"0"),t=(""+k%60).padStart(2,"0");O.textContent=e+":"+t,setTimeout(z,1e3)},J=()=>localStorage.setItem("time",k),R=document.body,A=document.createElement("header");localStorage.getItem("moves"),z(),d(),A.append(O),A.append(m),A.append(c);const j=document.createElement("div");j.className="top-wrapper",n(),a(f()),j.append(t),j.append(o),R.append(A),R.append(y),R.append(g),R.append(j),null===localStorage.getItem("field")?N(f()):(()=>{const e=f(),t=JSON.parse(localStorage.getItem("field"));for(let o=1;o<e*e;o++)$(t[o].row,t[o].column,o)})(),g.addEventListener("submit",(e=>{e.preventDefault(),L(),i=0,k=0,localStorage.removeItem("field"),localStorage.removeItem("fieldSize"),localStorage.removeItem("empty"),localStorage.removeItem("moves"),localStorage.removeItem("time"),y.style.gridTemplate=h(),b({row:f(),column:f()}),N(f()),n(),d(),a(f())}))})();